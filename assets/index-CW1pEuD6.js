(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();const es=(s,t)=>s===t,Mt=Symbol("solid-proxy"),ss=Symbol("solid-track"),wt={equals:es};let ge=ye;const J=1,mt=2,ve={owned:null,cleanups:null,context:null,owner:null};var I=null;let Tt=null,is=null,j=null,P=null,R=null,At=0;function Ot(s,t){const e=j,i=I,n=s.length===0,r=t===void 0?i:t,l=n?ve:{owned:null,cleanups:null,context:r?r.context:null,owner:r},a=n?s:()=>s(()=>K(()=>Ct(l)));I=l,j=null;try{return nt(a,!0)}finally{j=e,I=i}}function Y(s,t){t=t?Object.assign({},wt,t):wt;const e={value:s,observers:null,observerSlots:null,comparator:t.equals||void 0},i=n=>(typeof n=="function"&&(n=n(e.value)),be(e,n));return[me.bind(e),i]}function q(s,t,e){const i=ae(s,t,!1,J);ct(i)}function ns(s,t,e){ge=os;const i=ae(s,t,!1,J);i.user=!0,R?R.push(i):ct(i)}function L(s,t,e){e=e?Object.assign({},wt,e):wt;const i=ae(s,t,!0,0);return i.observers=null,i.observerSlots=null,i.comparator=e.equals||void 0,ct(i),me.bind(i)}function It(s){return nt(s,!1)}function K(s){if(j===null)return s();const t=j;j=null;try{return s()}finally{j=t}}function rs(s,t,e){const i=Array.isArray(s);let n;return r=>{let l;if(i){l=Array(s.length);for(let h=0;h<s.length;h++)l[h]=s[h]()}else l=s();const a=K(()=>t(l,n,r));return n=l,a}}function we(s){return I===null||(I.cleanups===null?I.cleanups=[s]:I.cleanups.push(s)),s}function ls(s){const t=L(s),e=L(()=>Nt(t()));return e.toArray=()=>{const i=e();return Array.isArray(i)?i:i!=null?[i]:[]},e}function me(){if(this.sources&&this.state)if(this.state===J)ct(this);else{const s=P;P=null,nt(()=>yt(this),!1),P=s}if(j){const s=this.observers?this.observers.length:0;j.sources?(j.sources.push(this),j.sourceSlots.push(s)):(j.sources=[this],j.sourceSlots=[s]),this.observers?(this.observers.push(j),this.observerSlots.push(j.sources.length-1)):(this.observers=[j],this.observerSlots=[j.sources.length-1])}return this.value}function be(s,t,e){let i=s.value;return(!s.comparator||!s.comparator(i,t))&&(s.value=t,s.observers&&s.observers.length&&nt(()=>{for(let n=0;n<s.observers.length;n+=1){const r=s.observers[n],l=Tt&&Tt.running;l&&Tt.disposed.has(r),(l?!r.tState:!r.state)&&(r.pure?P.push(r):R.push(r),r.observers&&$e(r)),l||(r.state=J)}if(P.length>1e6)throw P=[],new Error},!1)),t}function ct(s){if(!s.fn)return;Ct(s);const t=At;as(s,s.value,t)}function as(s,t,e){let i;const n=I,r=j;j=I=s;try{i=s.fn(t)}catch(l){return s.pure&&(s.state=J,s.owned&&s.owned.forEach(Ct),s.owned=null),s.updatedAt=e+1,ke(l)}finally{j=r,I=n}(!s.updatedAt||s.updatedAt<=e)&&(s.updatedAt!=null&&"observers"in s?be(s,i):s.value=i,s.updatedAt=e)}function ae(s,t,e,i=J,n){const r={fn:s,state:i,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:I,context:I?I.context:null,pure:e};return I===null||I!==ve&&(I.owned?I.owned.push(r):I.owned=[r]),r}function bt(s){if(s.state===0)return;if(s.state===mt)return yt(s);if(s.suspense&&K(s.suspense.inFallback))return s.suspense.effects.push(s);const t=[s];for(;(s=s.owner)&&(!s.updatedAt||s.updatedAt<At);)s.state&&t.push(s);for(let e=t.length-1;e>=0;e--)if(s=t[e],s.state===J)ct(s);else if(s.state===mt){const i=P;P=null,nt(()=>yt(s,t[0]),!1),P=i}}function nt(s,t){if(P)return s();let e=!1;t||(P=[]),R?e=!0:R=[],At++;try{const i=s();return hs(e),i}catch(i){e||(R=null),P=null,ke(i)}}function hs(s){if(P&&(ye(P),P=null),s)return;const t=R;R=null,t.length&&nt(()=>ge(t),!1)}function ye(s){for(let t=0;t<s.length;t++)bt(s[t])}function os(s){let t,e=0;for(t=0;t<s.length;t++){const i=s[t];i.user?s[e++]=i:bt(i)}for(t=0;t<e;t++)bt(s[t])}function yt(s,t){s.state=0;for(let e=0;e<s.sources.length;e+=1){const i=s.sources[e];if(i.sources){const n=i.state;n===J?i!==t&&(!i.updatedAt||i.updatedAt<At)&&bt(i):n===mt&&yt(i,t)}}}function $e(s){for(let t=0;t<s.observers.length;t+=1){const e=s.observers[t];e.state||(e.state=mt,e.pure?P.push(e):R.push(e),e.observers&&$e(e))}}function Ct(s){let t;if(s.sources)for(;s.sources.length;){const e=s.sources.pop(),i=s.sourceSlots.pop(),n=e.observers;if(n&&n.length){const r=n.pop(),l=e.observerSlots.pop();i<n.length&&(r.sourceSlots[l]=i,n[i]=r,e.observerSlots[i]=l)}}if(s.owned){for(t=s.owned.length-1;t>=0;t--)Ct(s.owned[t]);s.owned=null}if(s.cleanups){for(t=s.cleanups.length-1;t>=0;t--)s.cleanups[t]();s.cleanups=null}s.state=0}function cs(s){return s instanceof Error?s:new Error(typeof s=="string"?s:"Unknown error",{cause:s})}function ke(s,t=I){throw cs(s)}function Nt(s){if(typeof s=="function"&&!s.length)return Nt(s());if(Array.isArray(s)){const t=[];for(let e=0;e<s.length;e++){const i=Nt(s[e]);Array.isArray(i)?t.push.apply(t,i):t.push(i)}return t}return s}const ce=Symbol("fallback");function ue(s){for(let t=0;t<s.length;t++)s[t]()}function us(s,t,e={}){let i=[],n=[],r=[],l=[],a=0,h;return we(()=>ue(r)),()=>{const u=s()||[];return u[ss],K(()=>{if(u.length===0)return a!==0&&(ue(r),r=[],i=[],n=[],a=0,l=[]),e.fallback&&(i=[ce],n[0]=Ot(o=>(r[0]=o,e.fallback())),a=1),n;for(i[0]===ce&&(r[0](),r=[],i=[],n=[],a=0),h=0;h<u.length;h++)h<i.length&&i[h]!==u[h]?l[h](()=>u[h]):h>=i.length&&(n[h]=Ot(f));for(;h<i.length;h++)r[h]();return a=l.length=r.length=u.length,i=u.slice(0),n=n.slice(0,a)});function f(o){r[h]=o;const[c,d]=Y(u[h]);return l[h]=d,t(c,h)}}}let ds=!1;function w(s,t){return K(()=>s(t||{}))}function dt(){return!0}const fs={get(s,t,e){return t===Mt?e:s.get(t)},has(s,t){return t===Mt?!0:s.has(t)},set:dt,deleteProperty:dt,getOwnPropertyDescriptor(s,t){return{configurable:!0,enumerable:!0,get(){return s.get(t)},set:dt,deleteProperty:dt}},ownKeys(s){return s.keys()}};function Pt(s){return(s=typeof s=="function"?s():s)?s:{}}function _s(){for(let s=0,t=this.length;s<t;++s){const e=this[s]();if(e!==void 0)return e}}function U(...s){let t=!1;for(let l=0;l<s.length;l++){const a=s[l];t=t||!!a&&Mt in a,s[l]=typeof a=="function"?(t=!0,L(a)):a}if(t)return new Proxy({get(l){for(let a=s.length-1;a>=0;a--){const h=Pt(s[a])[l];if(h!==void 0)return h}},has(l){for(let a=s.length-1;a>=0;a--)if(l in Pt(s[a]))return!0;return!1},keys(){const l=[];for(let a=0;a<s.length;a++)l.push(...Object.keys(Pt(s[a])));return[...new Set(l)]}},fs);const e={},i=Object.create(null);for(let l=s.length-1;l>=0;l--){const a=s[l];if(!a)continue;const h=Object.getOwnPropertyNames(a);for(let u=h.length-1;u>=0;u--){const f=h[u];if(f==="__proto__"||f==="constructor")continue;const o=Object.getOwnPropertyDescriptor(a,f);if(!i[f])i[f]=o.get?{enumerable:!0,configurable:!0,get:_s.bind(e[f]=[o.get.bind(a)])}:o.value!==void 0?o:void 0;else{const c=e[f];c&&(o.get?c.push(o.get.bind(a)):o.value!==void 0&&c.push(()=>o.value))}}}const n={},r=Object.keys(i);for(let l=r.length-1;l>=0;l--){const a=r[l],h=i[a];h&&h.get?Object.defineProperty(n,a,h):n[a]=h?h.value:void 0}return n}const xe=s=>`Stale read from <${s}>.`;function ps(s){const t="fallback"in s&&{fallback:()=>s.fallback};return L(us(()=>s.each,s.children,t||void 0))}function H(s){const t=s.keyed,e=L(()=>s.when,void 0,{equals:(i,n)=>t?i===n:!i==!n});return L(()=>{const i=e();if(i){const n=s.children;return typeof n=="function"&&n.length>0?K(()=>n(t?i:()=>{if(!K(e))throw xe("Show");return s.when})):n}return s.fallback},void 0,void 0)}function gs(s){let t=!1;const e=(r,l)=>(t?r[1]===l[1]:!r[1]==!l[1])&&r[2]===l[2],i=ls(()=>s.children),n=L(()=>{let r=i();Array.isArray(r)||(r=[r]);for(let l=0;l<r.length;l++){const a=r[l].when;if(a)return t=!!r[l].keyed,[l,a,r[l]]}return[-1]},void 0,{equals:e});return L(()=>{const[r,l,a]=n();if(r<0)return s.fallback;const h=a.children;return typeof h=="function"&&h.length>0?K(()=>h(t?l:()=>{if(K(n)[0]!==r)throw xe("Match");return a.when})):h},void 0,void 0)}function ft(s){return s}function vs(s,t,e){let i=e.length,n=t.length,r=i,l=0,a=0,h=t[n-1].nextSibling,u=null;for(;l<n||a<r;){if(t[l]===e[a]){l++,a++;continue}for(;t[n-1]===e[r-1];)n--,r--;if(n===l){const f=r<i?a?e[a-1].nextSibling:e[r-a]:h;for(;a<r;)s.insertBefore(e[a++],f)}else if(r===a)for(;l<n;)(!u||!u.has(t[l]))&&t[l].remove(),l++;else if(t[l]===e[r-1]&&e[a]===t[n-1]){const f=t[--n].nextSibling;s.insertBefore(e[a++],t[l++].nextSibling),s.insertBefore(e[--r],f),t[n]=e[r]}else{if(!u){u=new Map;let o=a;for(;o<r;)u.set(e[o],o++)}const f=u.get(t[l]);if(f!=null)if(a<f&&f<r){let o=l,c=1,d;for(;++o<n&&o<r&&!((d=u.get(t[o]))==null||d!==f+c);)c++;if(c>f-a){const _=t[l];for(;a<f;)s.insertBefore(e[a++],_)}else s.replaceChild(e[a++],t[l++])}else l++;else t[l++].remove()}}}function ws(s,t,e,i={}){let n;return Ot(r=>{n=r,t===document?s():m(t,s(),t.firstChild?null:void 0,e)},i.owner),()=>{n(),t.textContent=""}}function A(s,t,e){let i;const n=()=>{const l=document.createElement("template");return l.innerHTML=s,e?l.content.firstChild.firstChild:l.content.firstChild},r=t?()=>K(()=>document.importNode(i||(i=n()),!0)):()=>(i||(i=n())).cloneNode(!0);return r.cloneNode=r,r}function ms(s,t,e){s.removeAttribute(t)}function B(s,t){t==null?s.removeAttribute("class"):s.className=t}function bs(s,t,e){if(!t)return e?ms(s,"style"):t;const i=s.style;if(typeof t=="string")return i.cssText=t;typeof e=="string"&&(i.cssText=e=void 0),e||(e={}),t||(t={});let n,r;for(r in e)t[r]==null&&i.removeProperty(r),delete e[r];for(r in t)n=t[r],n!==e[r]&&(i.setProperty(r,n),e[r]=n);return e}function m(s,t,e,i){if(e!==void 0&&!i&&(i=[]),typeof t!="function")return $t(s,t,i,e);q(n=>$t(s,t(),n,e),i)}function $t(s,t,e,i,n){for(;typeof e=="function";)e=e();if(t===e)return e;const r=typeof t,l=i!==void 0;if(s=l&&e[0]&&e[0].parentNode||s,r==="string"||r==="number"){if(r==="number"&&(t=t.toString(),t===e))return e;if(l){let a=e[0];a&&a.nodeType===3?a.data!==t&&(a.data=t):a=document.createTextNode(t),e=Z(s,e,i,a)}else e!==""&&typeof e=="string"?e=s.firstChild.data=t:e=s.textContent=t}else if(t==null||r==="boolean")e=Z(s,e,i);else{if(r==="function")return q(()=>{let a=t();for(;typeof a=="function";)a=a();e=$t(s,a,e,i)}),()=>e;if(Array.isArray(t)){const a=[],h=e&&Array.isArray(e);if(qt(a,t,e,n))return q(()=>e=$t(s,a,e,i,!0)),()=>e;if(a.length===0){if(e=Z(s,e,i),l)return e}else h?e.length===0?de(s,a,i):vs(s,e,a):(e&&Z(s),de(s,a));e=a}else if(t.nodeType){if(Array.isArray(e)){if(l)return e=Z(s,e,i,t);Z(s,e,null,t)}else e==null||e===""||!s.firstChild?s.appendChild(t):s.replaceChild(t,s.firstChild);e=t}}return e}function qt(s,t,e,i){let n=!1;for(let r=0,l=t.length;r<l;r++){let a=t[r],h=e&&e[s.length],u;if(!(a==null||a===!0||a===!1))if((u=typeof a)=="object"&&a.nodeType)s.push(a);else if(Array.isArray(a))n=qt(s,a,h)||n;else if(u==="function")if(i){for(;typeof a=="function";)a=a();n=qt(s,Array.isArray(a)?a:[a],Array.isArray(h)?h:[h])||n}else s.push(a),n=!0;else{const f=String(a);h&&h.nodeType===3&&h.data===f?s.push(h):s.push(document.createTextNode(f))}}return n}function de(s,t,e=null){for(let i=0,n=t.length;i<n;i++)s.insertBefore(t[i],e)}function Z(s,t,e,i){if(e===void 0)return s.textContent="";const n=i||document.createTextNode("");if(t.length){let r=!1;for(let l=t.length-1;l>=0;l--){const a=t[l];if(n!==a){const h=a.parentNode===s;!r&&!l?h?s.replaceChild(n,a):s.insertBefore(n,e):h&&a.remove()}else r=!0}}else s.insertBefore(n,e);return[n]}var ys=Object.defineProperty,$s=(s,t,e)=>t in s?ys(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,g=(s,t,e)=>$s(s,typeof t!="symbol"?t+"":t,e);const y=class{constructor(t,e,i,n,r,l,a,h,u){this.quad=t,this.high=e,this.pair=i,this.pair2=n,this.set=r,this.full=l,this.straight=a,this.flush=h,this.sflush=u}get rank_name(){if(this.quad)return"quad";if(this.high)return"high";if(this.pair)return"pair";if(this.pair2)return"ppair";if(this.set)return"set";if(this.full)return"full";if(this.straight)return"straight";if(this.flush)return"flush";if(this.sflush)return"sflush"}get high_card(){if(this.quad)return this.quad;if(this.high)return this.high[0];if(this.pair)return this.pair[0];if(this.pair2)return this.pair2[0];if(this.set)return this.set[0];if(this.full)return this.full[0];if(this.straight)return this.straight;if(this.flush)return this.flush[0];if(this.sflush)return this.sflush}get fen(){if(this.quad)return`quad ${this.quad}`;if(this.high)return`high ${this.high.join(" ")}`;if(this.full)return`full ${this.full.join(" ")}`;if(this.set)return`set ${this.set.join(" ")}`;if(this.pair2)return`ppair ${this.pair2.join(" ")}`;if(this.pair)return`pair ${this.pair.join(" ")}`;if(this.sflush)return`sflush ${this.sflush}`;if(this.straight)return`straight ${this.straight}`;if(this.flush)return`flush ${this.flush.join(" ")}`}get hand_eval(){return 0}};g(y,"from_fen",s=>{let[t,...e]=s.split(" ");switch(t){case"high":return y.high(e);case"pair":return y.pair(e);case"ppair":return y.pair2(e);case"set":return y.set(e);case"full":return y.full(e);case"straight":return y.straight(e[0]);case"flush":return y.flush(e);case"quad":return y.quad(e[0]);case"sflush":return y.sflush(e[0])}}),g(y,"quad",s=>new y(s)),g(y,"high",s=>new y(void 0,s)),g(y,"pair",s=>new y(void 0,void 0,s)),g(y,"pair2",s=>new y(void 0,void 0,void 0,s)),g(y,"set",s=>new y(void 0,void 0,void 0,void 0,s)),g(y,"full",s=>new y(void 0,void 0,void 0,void 0,void 0,s)),g(y,"straight",s=>new y(void 0,void 0,void 0,void 0,void 0,void 0,s)),g(y,"flush",s=>new y(void 0,void 0,void 0,void 0,void 0,void 0,void 0,s)),g(y,"sflush",s=>new y(void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,s));let ks=y;function xs(s){return new ks}const As="23456789TJQKA".split(""),Cs="cdhs".split("");function Q(s,t=s.length/2){return[...Array(t).keys()].map(e=>s.slice(e*2,e*2+2))}Cs.flatMap(s=>As.map(t=>`${t}${s}`));const Ss=s=>s.every(t=>t===s[0]);function Ae(s){return s.reduce((t,e)=>t+e,0)}let Es={p:"f",f:"t",t:"r"};function js(s){return Es[s]}function W(s,t){return s.find(e=>e>t)??Math.min(...s)}function Lt(s,t){let e=[];return s.forEach((i,n)=>{t(i)&&e.push(n+1)}),e}const Bt=class{constructor(t,e,i,n,r,l,a,h){this.small_blind=t,this.button=e,this.stacks=i,this.pot=n,this.flop=r,this.turn=l,this.river=a,this.shares=h}get total_pot(){var t;return Ae(this.stacks.map(e=>{var i;return((i=e.bet)==null?void 0:i.total)??0}))+(((t=this.pot)==null?void 0:t.total_pot)??0)}get middle(){let t=[];return this.flop&&t.push(...this.flop),this.turn&&t.push(this.turn),this.river&&t.push(this.river),t}get fen(){var t,e,i;let{small_blind:n,button:r}=this,l=n*2,a=`${n}-${l} ${r}`,h=this.stacks.map(c=>c.fen).join(" / "),u=(t=this.pot)==null?void 0:t.fen;u?u=` ${u} `:u="";let f=(((e=this.flop)==null?void 0:e.join(""))??"")+(this.turn??"")+(this.river??""),o=((i=this.shares)==null?void 0:i.map(c=>c.fen).join(" "))??"";return o&&(o=` shares ${o}`),`${a} | ${h} $${u}!${f}${o}`}};g(Bt,"from_fen",s=>{let[t,e]=s.split("shares"),[i,n]=t.trim().split("!"),[r,l]=i.split("$"),[a,h]=r.split("|"),[u,f]=a.split(" "),[o]=u.split("-"),c=n===""?void 0:Q(n),d,_,p;return c&&(d=c.slice(0,3),_=c[3],p=c[4]),new Bt(x(o),x(f),h.split("/").map(Ut.from_fen),l===""?void 0:he.from_fen(l),d,_,p,e==null?void 0:e.trim().split(" ").map($=>it.from_fen($)))});let Ts=Bt;function x(s){return parseInt(s)}function M(s,t,e){let i=e-t+1;return i<1?i+s:i}function Is(s,t){return t+1>s?1:t+1}const rt=class tt{constructor(t,e,i){this.win=t,this.back=e,this.swin=i}static win(t,e){return new tt([t,e])}static back(t,e){return new tt(void 0,[t,e])}static swin(t,e){return new tt(void 0,void 0,[t,e])}get clone(){var t,e,i;let n=(t=this.win)==null?void 0:t.slice(0),r=(e=this.back)==null?void 0:e.slice(0),l=(i=this.swin)==null?void 0:i.slice(0);return new tt(n,r,l)}pov(t,e){let{win:i,back:n,swin:r}=this,l=i?[M(t,e,i[0]),i[1]]:void 0,a=n?[M(t,e,n[0]),n[1]]:void 0,h=r?[M(t,e,r[0]),r[1]]:void 0;return new tt(l,a,h)}get fen(){let{win:t,back:e,swin:i}=this;if(t)return`win-${t[0]}-${t[1]}`;if(e)return`back-${e[0]}-${e[1]}`;if(i)return`swin-${i[0]}-${i[1]}`}};g(rt,"from_fen",s=>{let[t,e,i]=s.split("-"),n=x(e),r=x(i);return t==="win"?rt.win(n,r):t==="swin"?rt.swin(n,r):rt.back(n,r)});let it=rt;class St{constructor(t){this.match=t}static from_fen(t){let[e,i]=t.split("-");if(e==="call")return new St(parseInt(i))}get fen(){return`call-${this.match}`}}const lt=class pt{constructor(t,e,i,n){this.match=t,this.min_raise=e,this.cant_match=i,this.cant_minraise=n}static from_fen(t){let[e,i]=t.split("x"),[n,r,l]=e.split("-");if(n==="raise"){let a=parseInt(r),h=parseInt(l);if(i){let[u,f]=i.split("-"),o=parseInt(u),c=parseInt(f);return c===0?pt.cant_match(a,h,o):pt.cant_minraise(a,h,c)}else return new pt(a,h)}}get fen(){let t=this.cant_match!==void 0?`x${this.cant_match}-0`:this.cant_minraise!==void 0?`x${this.match}-${this.cant_minraise}`:"";return`raise-${this.match}-${this.min_raise}${t}`}};g(lt,"cant_match",(s,t,e)=>new lt(s,t,e)),g(lt,"cant_minraise",(s,t,e)=>new lt(s,t,void 0,e));let et=lt;const Kt=class Ce{constructor(t,e,i,n){this.desc=t,this.previous=e,this.match=i,this.raise=n}get clone(){let{desc:t,previous:e,match:i,raise:n}=this;return new Ce(t,e,i,n)}get total(){return this.previous+(this.match??0)+(this.raise??0)}get fen(){let{desc:t,previous:e,match:i,raise:n}=this,r=i!==void 0?`-${i}`:"",l=n!==void 0?`-${n}`:"";return`${t}-${e}${r}${l}`}};g(Kt,"from_fen",s=>{let[t,e,i,n]=s.split("-");return new Kt(t,x(e),i?x(i):void 0,n?x(n):void 0)});let kt=Kt;const at=class Ht{constructor(t,e,i,n){this.state=t,this.stack=e,this.hand=i,this.bet=n}get clone(){var t,e;let{state:i,stack:n}=this,r=(t=this.hand)==null?void 0:t.slice(0),l=(e=this.bet)==null?void 0:e.clone;return new Ht(i,n,r,l)}get hide_cards(){let{state:t,stack:e,bet:i,hand:n}=this,r=t==="s"?n:void 0;return new Ht(t,e,r,i)}get fen(){let{stack:t,state:e,bet:i,hand:n}=this,r=n?`${n.join("")}`:void 0,l=i?i.fen:void 0,a=r?l?`${r} ${l}`:r:l;return a?`${e}${t} ${a}`:`${e}${t}`}post_bet(t,e,i,n){e?this.bet?this.bet=new kt(e,this.bet.total,i,n):this.bet=new kt(e,0,i,n):this.bet=void 0;let r=(i??0)+(n??0);this.stack-=r;let l=[];return l.push(new Qe(t,this.bet)),r>0&&l.push(new Je(t,r)),l}};g(at,"make",s=>new at("d",s)),g(at,"from_fen",s=>{let t=s.trim()[0],[e,i,n]=s.trim().slice(1).split(" "),r=n,l=i;return i&&(i.length===4&&i!=="fold"||(r=i,l=void 0)),new at(t,x(e),l?Q(l,2):void 0,r?kt.from_fen(r):void 0)});let Ut=at;const Ft=class N{constructor(t,e,i,n,r,l,a,h,u,f){this.deal=t,this.phase=e,this.showdown=i,this.share=n,this.check=r,this.fold=l,this.call=a,this.raise=h,this.fin=u,this.win=f}static get empty(){return new N}static deal(t){return new N(t)}static get phase(){return new N(void 0,!0)}static get showdown(){return new N(void 0,void 0,!0)}static get share(){return new N(void 0,void 0,void 0,!0)}static get check(){return new N(void 0,void 0,void 0,void 0,!0)}static get fold(){return new N(void 0,void 0,void 0,void 0,void 0,!0)}static call(t){return new N(void 0,void 0,void 0,void 0,void 0,void 0,t)}static raise(t){return new N(void 0,void 0,void 0,void 0,void 0,void 0,void 0,t)}static get fin(){return new N(void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,!0)}static get win(){return new N(void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,!0)}get dealer_action(){return this.deal||this.phase||this.showdown||this.share||this.fin||this.win}get fen(){if(this.win)return"win";if(this.fin)return"fin";if(this.deal)return`deal-${this.deal}`;if(this.phase)return"phase";if(this.showdown)return"showdown";if(this.share)return"share";let{check:t,call:e,raise:i,fold:n}=this,r=[];return t&&r.push("check"),e&&r.push(e.fen),i&&r.push(i.fen),n&&r.push("fold"),r.join(" ")}};g(Ft,"from_fen",s=>{let t=s.split(" "),e=Ft.empty;return t.forEach(i=>{i==="win"&&(e.win=!0),i==="fin"&&(e.fin=!0),i==="phase"&&(e.phase=!0),i==="showdown"&&(e.showdown=!0),i==="share"&&(e.share=!0),i==="check"&&(e.check=!0),i==="fold"&&(e.fold=!0);let n=St.from_fen(i);n&&(e.call=n);let r=et.from_fen(i);r&&(e.raise=r);let[l,a]=i.split("-");l==="deal"&&(e.deal=parseInt(a))}),e});let V=Ft;const st=class Dt{constructor(t,e,i){this.chips=t,this.sides=e,this.side_pots=i}get clone(){var t;let{chips:e}=this,i=this.sides.slice(0),n=(t=this.side_pots)==null?void 0:t.map(r=>r.clone);return new Dt(e,i,n)}get total_pot(){var t;return this.chips+Ae(((t=this.side_pots)==null?void 0:t.map(e=>e.chips))??[])}exclude_fold(t){this.sides=this.sides.filter(e=>e!==t)}add_bet(t,e,i){var n;return i&&(this.exclude_fold(t),(n=this.side_pots)==null||n.forEach(r=>r.exclude_fold(t))),!i&&!this.sides.includes(t)&&this.sides.push(t),this.chips+=e.total,e.total>0?[new Pe(t,e.total)]:[]}side_pot(t,e){let i=this.sides,n=e*i.length;this.side_pots||(this.side_pots=[]);let r=new Dt(n,i);return this.side_pots.push(r),this.sides=this.sides.filter(l=>!t.includes(l)),this.chips-=n,new Te(t,e)}get fen(){let t=this.side_pots?`side ${this.side_pots.map(e=>e.fen).join(" ")}`:"";return`${this.chips}-${this.sides.join("")}${t}`}};g(st,"from_fen",s=>{let[t,e]=s.trim().split("side"),[i,n]=t.split("-"),r=e==null?void 0:e.trim().split(" ").map(l=>st.from_fen(l));return new st(x(i),n.split("").map(l=>x(l)),r)}),g(st,"empty",()=>new st(0,[]));let he=st;const ht=class Se{constructor(t,e,i,n,r,l,a){this.small_blind=t,this.button=e,this.stacks=i,this.pot=n,this.middle=r,this.phase=l,this.shares=a}get clone(){var t,e,i;let{small_blind:n,button:r,phase:l}=this,a=this.stacks.map(o=>o.clone),h=(t=this.pot)==null?void 0:t.clone,u=(e=this.middle)==null?void 0:e.slice(0),f=(i=this.shares)==null?void 0:i.map(o=>o.clone);return new Se(n,r,a,h,u,l,f)}get nb(){return this.stacks.length}find_stack_sides_with_states(t){return Array.isArray(t)||(t=[t]),Lt(this.stacks,e=>t.includes(e.state))}find_stacks_with_states(t){return Array.isArray(t)||(t=[t]),this.stacks.filter(e=>t.includes(e.state))}get have_played_sides(){return this.find_stack_sides_with_states(["p","a","f","d","i","@","s","w"])}get small_blind_side(){return W(this.have_played_sides,this.button)}get big_blind_side(){return W(this.have_played_sides,this.small_blind_side)}get action_side(){return this.find_stack_sides_with_states("@")[0]}get action(){return this.stacks[this.action_side-1]}get in_other_than_action_sides(){return this.find_stack_sides_with_states(["i"])}get in_other_than_actions(){return this.find_stacks_with_states(["i"])}get allin_and_in_other_than_actions(){return this.find_stacks_with_states(["i","a"])}get allin_and_in_other_than_action_sides(){return this.find_stack_sides_with_states(["i","a"])}get in_action_next(){let{action_side:t,in_other_than_action_sides:e}=this;return W(e,t)}get ins(){return this.find_stacks_with_states(["i","@"])}get in_sides(){return this.find_stack_sides_with_states(["i","@"])}get phases(){return this.find_stacks_with_states("p")}get phase_sides(){return this.find_stack_sides_with_states("p")}get allin_sides(){return this.find_stack_sides_with_states("a")}get fold_sides(){return this.find_stack_sides_with_states("f")}get showdown_sides(){return this.find_stack_sides_with_states("s")}get have_contributed_to_pots(){return this.stacks.filter(t=>!!t.bet)}get have_contributed_to_pot_sides(){return Lt(this.stacks,t=>!!t.bet)}pov(t){var e,i,n,r;let{small_blind:l,button:a,phase:h,stacks:u,nb:f}=this,o=u.slice(t-1);t!==1&&(o=[...o,...u.slice(0,t-1)]);let c=h!=="p",d=h==="t"||h==="r",_=h==="r";this.showdown_sides.length>0&&(c=!0,d=!0,_=!0);let p=c?(e=this.middle)==null?void 0:e.slice(0,3):void 0,$=d?(i=this.middle)==null?void 0:i[3]:void 0,C=_?(n=this.middle)==null?void 0:n[4]:void 0;return new Ts(l,M(f,t,a),o.map((b,k)=>k===0?b:b.hide_cards),this.pot,p,$,C,(r=this.shares)==null?void 0:r.map(b=>b.pov(f,t)))}get fen(){var t,e;let{small_blind:i,button:n,phase:r}=this,l=i*2,a=`${i}-${l} ${n}`,h=this.stacks.map(c=>c.fen).join(" / "),u=(t=this.pot)==null?void 0:t.fen;u?u=` ${u} `:u="";let f=((e=this.middle)==null?void 0:e.join(""))??"",o=this.shares?` shares ${this.shares.map(c=>c.fen).join(" ")}`:"";return`${a} | ${h} $${u}!${r??""}${f}${o}`}get dests(){let{action:t,allin_and_in_other_than_actions:e,in_other_than_action_sides:i}=this;if(t){let n=V.fold,r=t.stack,l=t.bet,a=e.map(_=>{var p;return((p=_.bet)==null?void 0:p.total)??0}),h=e.map(_=>{var p;return((p=_.bet)==null?void 0:p.raise)??0}),u=Math.max(...a),f=Math.max(...h),o=(l==null?void 0:l.total)??0,c=u-o;c===0?n.check=!0:c>0&&r>c&&(n.call=new St(c));let d=Math.max(this.small_blind*2,f);return i.length===0?r<c?n.raise=et.cant_match(c,d,r):r===c&&(n.raise=et.cant_minraise(c,d,0)):r<c?n.raise=et.cant_match(c,d,r):r-c<d?n.raise=et.cant_minraise(c,d,r-c):n.raise=new et(c,d),n}else return this.find_stack_sides_with_states("w").length>0?this.shares?V.share:V.win:this.find_stack_sides_with_states("x").length>0?V.fin:this.find_stack_sides_with_states("d").length>0?V.deal(this.nb):this.find_stack_sides_with_states("s").length>0?this.shares?V.share:V.showdown:V.phase}act(t){var e,i;let n=new Xe(this.nb),[r,l]=t.split(" "),{nb:a,small_blind:h}=this,u=h*2,{big_blind_side:f}=this;switch(r){case"deal":{let{small_blind_side:o,big_blind_side:c}=this,d=this.find_stack_sides_with_states("d"),_=W(d,c),p=_,$=this.stacks[c-1].stack,C=$<=u,b=this.stacks[o-1].stack,k=b<=h,E=C&&h>=$;k&&p===o&&(_=W(d,_),p=_),d.forEach(S=>{k&&S===o?n.all(this.change_state(S,"a")):E&&S===o?n.all(this.change_state(S,"p")):k&&S===c&&S===p?n.all(this.change_state(S,"p")):C&&S===c?n.all(this.change_state(S,"a")):S===_?n.all(this.change_state(S,"@")):n.all(this.change_state(S,"i"))});let v;C?v=this.post_bet(c,"allin",0,$):k&&p===c?v=this.post_bet(c,"call",b):v=this.post_bet(c,"bb",0,u);let T;k?T=this.post_bet(o,"allin",0,b):E?T=this.post_bet(o,"call",$):T=this.post_bet(o,"sb",0,h),n.all(T),n.all(v),this.middle=Q(l.slice(a*4,a*4+10),5),d.forEach((S,jt)=>{let ut=this.stacks[S-1];ut.hand=Q(l.slice(jt*4),2),n.only(S,new gt(S,ut.hand))}),this.phase="p"}break;case"phase":{let{fold_sides:o,allin_sides:c,phase_sides:d,phase:_}=this,p=d.length<=1,$=this.find_stack_sides_with_states("a"),C=c.filter(v=>this.stacks[v-1].bet),b=p&&$.length===0,k=$.length>1,E=d.length===0&&C.length===1;if(this.pot||(this.pot=he.empty()),[...d,...c].forEach(v=>{let T=this.stacks[v-1];T.bet&&n.all(this.pot.add_bet(v,T.bet))}),o.forEach(v=>{let T=this.stacks[v-1];T.bet&&n.all(this.pot.add_bet(v,T.bet,!0))}),!E){let v=0;C.sort((T,S)=>{let jt=this.stacks[T-1].bet.total,ut=this.stacks[S-1].bet.total;return jt-ut}).forEach(T=>{let S=this.stacks[T-1].bet.total-v;n.all(this.pot.side_pot([T],S)),v+=S})}if([...c,...o,...d].forEach(v=>{n.all(this.post_bet(v))}),!b&&!E&&(_==="p"?n.all(new oe(this.middle.slice(0,3))):_==="f"?n.all(new xt(this.middle[3])):_==="t"&&n.all(new ot(this.middle[4]))),p)!k&&E?c.forEach(v=>{n.all(this.change_state(v,"w"))}):b?d.forEach(v=>{n.all(this.change_state(v,"w"))}):($.forEach(v=>{n.others(v,new gt(v,this.stacks[v-1].hand))}),_==="p"?(n.all(new xt(this.middle[3])),n.all(new ot(this.middle[4]))):_==="f"&&n.all(new ot(this.middle[4])),[...d,...c].forEach(v=>{n.all(this.change_state(v,"s"))}));else if(_==="r")d.forEach(v=>{n.all(this.change_state(v,"s"))}),this.find_stack_sides_with_states("s").forEach(v=>{n.others(v,new gt(v,this.stacks[v-1].hand))});else{let v=this.stacks[f-1].state==="f"?W(d,f):f;d.forEach(T=>{T===v?n.all(this.change_state(T,"@")):n.all(this.change_state(T,"i"))}),this.phase=js(this.phase)}}break;case"showdown":[this.pot,...this.pot.side_pots??[]].forEach(o=>{let c=[],{sides:d,chips:_}=o;if(d.length!==0)if(d.length===1)c.push(it.back(d[0],_));else{let p=d.map(b=>xs([...this.middle,...this.stacks[b-1].hand]).hand_eval),$=Math.max(...p),C=d.filter((b,k)=>p[k]===$);if(C.length>1){let b=C[0];c.push(it.swin(b,_))}else{let b=C[0];c.push(it.swin(b,_))}}n.all(c.map(p=>this.pot_share(p)))});break;case"win":{let{sides:o,chips:c}=this.pot,d=o[0];n.all(this.pot_share(it.win(d,c)))}break;case"call":{let{action_side:o,in_action_next:c}=this,{ins:d,in_sides:_}=this,p=x(l);n.all(this.post_bet(o,"call",p));let $=d.every(k=>k.bet),C=d.every(k=>{var E,v;return((E=k.bet)==null?void 0:E.total)===((v=d[0].bet)==null?void 0:v.total)}),b=!d.find(k=>{var E;return((E=k.bet)==null?void 0:E.desc)==="bb"});$&&C&&b?_.forEach(k=>n.all(this.change_state(k,"p"))):(n.all(this.change_state(o,"i")),n.all(this.change_state(c,"@")))}break;case"raise":{let{action:o,action_side:c,in_action_next:d}=this,[_,p]=l.split("-").map(v=>x(v)),$=o.stack,C=_+p,b=(((e=o.bet)==null?void 0:e.total)??0)+C;$<=C?(n.all(this.post_bet(c,"allin",Math.min($,_),Math.max(0,Math.min($-_,p)))),n.all(this.change_state(c,"a"))):(n.all(this.post_bet(c,"raise",_,p)),n.all(this.change_state(c,"i")));let{in_other_than_action_sides:k}=this,E=k[0];k.length===1&&(((i=this.stacks[E-1].bet)==null?void 0:i.total)??0)>=b?n.all(this.change_state(d,"p")):k.length>0&&n.all(this.change_state(d,"@"))}break;case"share":{let{shares:o,have_played_sides:c}=this;n.all(this.collect_pot()),o.forEach(d=>{n.all(this.pot_share_stack_add(d))}),c.forEach(d=>{this.stacks[d-1].stack===0?n.all(this.change_state(d,"e")):n.all(this.change_state(d,"x")),n.all(this.collect_card(d))}),this.phase=void 0}break;case"check":{let{action_side:o,in_action_next:c}=this,{in_other_than_actions:d,in_sides:_}=this;d.every(p=>p.bet)?_.forEach(p=>n.all(this.change_state(p,"p"))):(n.all(this.change_state(o,"i")),n.all(this.change_state(c,"@"))),n.all(this.post_bet(o,"check"))}break;case"fold":{let{action_side:o,in_action_next:c}=this,{in_other_than_actions:d,in_other_than_action_sides:_}=this,p=this.find_stacks_with_states("a"),$=d.every(b=>b.bet),C=Ss(d.map(b=>{var k;return(k=b.bet)==null?void 0:k.total}));if(d.length===1)_.forEach(b=>n.all(this.change_state(b,"p")));else if($&&C){let b=Math.max(...p.map(E=>{var v;return((v=E.bet)==null?void 0:v.total)??0})),k=Math.max(...d.map(E=>E.bet.total));d.length===0||(k>=b?_.forEach(E=>n.all(this.change_state(E,"p"))):n.all(this.change_state(c,"@")))}else n.all(this.change_state(c,"@"));n.all(this.change_state(o,"f")),n.all(this.post_bet(o,"fold"))}break}return n}pot_share_stack_add(t){let{swin:e,win:i,back:n}=t;if(e){let[r,l]=e;return this.stacks[r-1].stack+=l,new F(r,l)}if(i){let[r,l]=i;return this.stacks[r-1].stack+=l,new F(r,l)}if(n){let[r,l]=n;return this.stacks[r-1].stack+=l,new F(r,l)}}collect_pot(){return this.pot=void 0,this.shares=void 0,this.middle=void 0,new qe}collect_card(t){return this.stacks[t-1].hand=void 0,new Be(t)}pot_share(t){return this.shares||(this.shares=[]),this.shares.push(t),new He(t)}change_state(t,e){return this.stacks[t-1].state=e,new Et(t,e)}post_bet(t,e,i,n){return this.stacks[t-1].post_bet(t,e,i,n)}};g(ht,"make",(s,t,e)=>new ht(s,t,e.map(i=>Ut.make(i)))),g(ht,"from_fen",s=>{let[t,e]=s.split("!"),[i,n]=t.split("$"),[r,l]=i.split("|"),[a,h]=r.split(" "),[u]=a.split("-"),f=e===""?void 0:Q(e.slice(1),5),o=e===""?void 0:e[0];return new ht(x(u),x(h),l.split("/").map(Ut.from_fen),n===""?void 0:he.from_fen(n),f,o)});let Ee=ht;class O{}g(O,"from_fen",s=>{let t;if(t=Et.from_fen(s),t||(t=gt.from_fen(s),t)||(t=Je.from_fen(s),t)||(t=Qe.from_fen(s),t)||(t=oe.from_fen(s),t)||(t=xt.from_fen(s),t)||(t=ot.from_fen(s),t)||(t=He.from_fen(s),t)||(t=Be.from_fen(s),t)||(t=qe.from_fen(s),t)||(t=F.from_fen(s),t)||(t=Oe.from_fen(s),t)||(t=Pe.from_fen(s),t)||(t=Te.from_fen(s),t))return t});const Rt=class je extends O{constructor(t,e){super(),this.shorts=t,this.chips=e}pov(t,e){return new je(this.shorts.map(i=>M(t,e,i)),this.chips)}get fen(){return`v ${this.shorts.join("")} ${this.chips}`}};g(Rt,"from_fen",s=>{let[t,e,i]=s.split(" ");if(t==="v")return new Rt(e.split("").map(n=>parseInt(n)),parseInt(i))});let Te=Rt;const Qt=class Ie extends O{constructor(t,e){super(),this.side=t,this.chips=e}pov(t,e){return new Ie(M(t,e,this.side),this.chips)}get fen(){return`p ${this.side} ${this.chips}`}};g(Qt,"from_fen",s=>{let[t,e,i]=s.split(" ");if(t==="p")return new Qt(parseInt(e),parseInt(i))});let Pe=Qt;const Vt=class Me extends O{constructor(t){super(),this.side=t}pov(t,e){return new Me(M(t,e,this.side))}get fen(){return`b ${this.side}`}};g(Vt,"from_fen",s=>{let[t,e]=s.split(" ");if(t==="b")return new Vt(parseInt(e))});let Oe=Vt;const Jt=class Ne extends O{constructor(t,e){super(),this.side=t,this.delta=e}pov(t,e){return new Ne(M(t,e,this.side),this.delta)}get fen(){return`S ${this.side} ${this.delta}`}};g(Jt,"from_fen",s=>{let[t,e,i]=s.split(" ");if(t==="S")return new Jt(parseInt(e),parseInt(i))});let F=Jt;const Wt=class extends O{pov(t,e){return this}get fen(){return"C"}};g(Wt,"from_fen",s=>{if(s==="C")return new Wt});let qe=Wt;const Gt=class Le extends O{constructor(t){super(),this.side=t}pov(t,e){return new Le(M(t,e,this.side))}get fen(){return`o ${this.side}`}};g(Gt,"from_fen",s=>{let[t,e]=s.split(" ");if(t==="o")return new Gt(parseInt(e))});let Be=Gt;const Xt=class Ke extends O{constructor(t){super(),this.share=t}pov(t,e){return new Ke(this.share.pov(t,e))}get fen(){return`w ${this.share.fen}`}};g(Xt,"from_fen",s=>{let[t,e]=s.split(" ");if(t==="w")return new Xt(it.from_fen(e))});let He=Xt;const Yt=class Ue extends O{constructor(t){super(),this.river=t}pov(t,e){return new Ue(this.river)}get fen(){return`r ${this.river}`}};g(Yt,"from_fen",s=>{let[t,e]=s.split(" ");if(t==="r")return new Yt(e)});let ot=Yt;const zt=class Fe extends O{constructor(t){super(),this.turn=t}pov(t,e){return new Fe(this.turn)}get fen(){return`t ${this.turn}`}};g(zt,"from_fen",s=>{let[t,e]=s.split(" ");if(t==="t")return new zt(e)});let xt=zt;const Zt=class De extends O{constructor(t){super(),this.flop=t}pov(t,e){return new De(this.flop)}get fen(){return`f ${this.flop.join("")}`}};g(Zt,"from_fen",s=>{let[t,e]=s.split(" ");if(t==="f")return new Zt(Q(e))});let oe=Zt;const te=class Re extends O{constructor(t,e){super(),this.side=t,this.bet=e}pov(t,e){return new Re(M(t,e,this.side),this.bet)}get fen(){return this.bet?`a ${this.side} ${this.bet.fen}`:`a ${this.side}`}};g(te,"from_fen",s=>{let[t,e,i]=s.split(" ");if(t==="a")return new te(parseInt(e),i?kt.from_fen(i):void 0)});let Qe=te;const ee=class Ve extends O{constructor(t,e){super(),this.side=t,this.delta=e}pov(t,e){return new Ve(M(t,e,this.side),this.delta)}get fen(){return`s ${this.side} ${this.delta}`}};g(ee,"from_fen",s=>{let[t,e,i]=s.split(" ");if(t==="s")return new ee(parseInt(e),parseInt(i))});let Je=ee;const se=class We extends O{constructor(t,e){super(),this.side=t,this.hand=e}pov(t,e){return new We(M(t,e,this.side),this.hand)}get fen(){return`h ${this.side} ${this.hand.join("")}`}};g(se,"from_fen",s=>{let[t,e,i]=s.split(" ");if(t==="h")return new se(parseInt(e),Q(i))});let gt=se;const ie=class Ge extends O{constructor(t,e){super(),this.side=t,this.state=e}pov(t,e){return new Ge(M(t,e,this.side),this.state)}get fen(){return`c ${this.side} ${this.state}`}};g(ie,"from_fen",s=>{let[t,e,i]=s.split(" ");if(t==="c")return new ie(parseInt(e),i)});let Et=ie;class Xe{constructor(t){g(this,"events"),g(this,"specs"),this.nb=t,this.specs=[],this.events=new Map;for(let e=1;e<=t;e++){let i=e;this.events.set(i,[])}}others(t,e){Array.isArray(e)||(e=[e]);for(let i of e){for(let n=1;n<=this.nb;n++){let r=n;r!==t&&this.events.get(r).push(i.pov(this.nb,r))}this.specs.push(i)}}all(t){Array.isArray(t)||(t=[t]);for(let e of t){for(let i=1;i<=this.nb;i++){let n=i;this.events.get(n).push(e.pov(this.nb,n))}this.specs.push(e)}}only(t,e){this.events.get(t).push(e.pov(this.nb,t)),this.specs.push(e)}pov(t){return this.events.get(t)}get spec(){return this.specs}get extra(){if(this.specs.find(t=>t instanceof Et&&t.state==="@")){let t=13e3,e=this.specs.find(r=>r instanceof oe),i=this.specs.find(r=>r instanceof xt),n=this.specs.find(r=>r instanceof ot);return e&&(t+=2e3),i&&(t+=3e3),n&&(t+=4e3),{time_left:t}}return{}}}class Ps{constructor(t,e,i,n,r,l,a){this.sit=t,this.lea=e,this.deal=i,this.folds=n,this.nexts=r,this.share=l,this.js=a}get fen(){let t=[];return this.sit&&t.push(`sit-${this.sit.join("")}`),this.lea&&t.push(`lea-${this.lea.join("")}`),this.deal&&t.push("deal"),this.js&&t.push(`i-${this.js.join("")}`),this.folds&&t.push(`f-${this.folds.join("")}`),this.nexts&&t.push(`n-${this.nexts.join("")}`),this.share&&t.push("share"),t.join(" ")}}const ne=class Ye{constructor(t,e){this.state=t,this.chips=e}static get empty(){return new Ye("e",0)}get fen(){return`${this.state}${this.chips}`}};g(ne,"from_fen",s=>{let t=s.trim()[0],e=s.trim().slice(1);return new ne(t,x(e))});let ze=ne;function _t(s,t){let e=[...Array(t)].map(i=>ze.empty);return new Ze(s,1,e)}const G=class re{constructor(t,e,i){this.small_blind=t,this.button=e,this.seats=i}get nb(){return this.seats.length}find_seat_sides_with_states(t){return Array.isArray(t)||(t=[t]),Lt(this.seats,e=>t.includes(e.state))}find_seat_with_states(t){return Array.isArray(t)||(t=[t]),this.seats.filter(e=>t.includes(e.state))}get spec(){let{nb:t,small_blind:e,button:i}=this,n=this.seats;return new re(e,M(t,1,i),n)}pov(t){let{nb:e,small_blind:i,button:n,seats:r}=this,l=r.slice(t-1);return t!==1&&(l=[...l,...r.slice(0,t-1)]),new re(i,M(e,t,n),l)}get fen(){let{small_blind:t,button:e}=this,i=t*2,n=`${t}-${i} ${e}`,r=this.seats.map(l=>l.fen).join(" / ");return`${n} | ${r}`}get dests(){let t=new Ps,e=this.find_seat_sides_with_states("e"),i=this.find_seat_sides_with_states("i");if(i.length>0){t.folds=i,e.length>0&&(t.nexts=e);let n=this.find_seat_sides_with_states("n");n.length>0&&(t.lea=n),t.share=!0;let r=this.find_seat_sides_with_states("j");r.length>0&&(t.js=r)}else{e.length>0&&(t.sit=e);let n=this.find_seat_sides_with_states(["s","w"]);n.length>0&&(t.lea=n),this.find_seat_sides_with_states("w").length>0&&(t.deal=!0)}return t}act(t){let e=new Xe(this.nb),[i,n]=t.split(" ");switch(i){case"sit":{let[r,l]=n.split("-"),a=x(r),h=x(l);this.seats[a-1].chips=h,e.all(new F(a,h));let u=this.find_seat_sides_with_states("s");u.length===1?(e.all(this.change_state(u[0],"w")),e.all(this.change_state(a,"w"))):e.all(this.change_state(a,"s"))}break;case"lea":{let r=x(n);e.all(this.leave(r));let l=this.find_seat_sides_with_states("w");l.length===1&&l.forEach(a=>{e.all(this.change_state(a,"s"))})}break;case"deal":{let r=this.find_seat_sides_with_states("w");r.forEach(a=>{e.all(this.change_state(a,"i"))});let l=W(r,this.button);this.button=l,e.all(new Oe(this.button))}break;case"share":{let r=n.split("-").map(x),l=this.find_seat_sides_with_states("j"),a=this.find_seat_sides_with_states("i"),h=this.find_seat_sides_with_states(["i","j"]),u=this.find_seat_sides_with_states("n");for(let o=0;o<r.length;o++)this.seats[h[o]-1].chips=r[o],e.all(new F(h[o],r[o]));l.forEach(o=>{e.all(this.change_state(o,"e")),this.seats[o-1].chips=0,e.all(new F(o,0))});let f=[...a,...u];f.length===1?f.forEach(o=>{e.all(this.change_state(o,"s"))}):f.forEach(o=>{e.all(this.change_state(o,"w"))})}break;case"next":{let[r,l]=n.split("-"),a=x(r),h=x(l);this.seats[a-1].chips=h,e.all(new F(a,h)),e.all(this.change_state(a,"n"))}break;case"fold":{let r=x(n);e.all(this.change_state(r,"j"))}break;case"in":{let r=x(n);e.all(this.change_state(r,"i"))}}return e}leave(t){let e=[];return this.seats[t-1].chips=0,e.push(new F(t,0)),e.push(this.change_state(t,"e")),e}change_state(t,e){return this.seats[t-1].state=e,new Et(t,e)}};g(G,"nine",s=>_t(s,9)),g(G,"six",s=>_t(s,6)),g(G,"three",s=>_t(s,3)),g(G,"headsup",s=>_t(s,2)),g(G,"from_fen",s=>{let[t,e]=s.split(" | "),[i,n]=t.split(" "),[r]=i.split("-");return new G(x(r),x(n),e.split(" / ").map(ze.from_fen))});let Ze=G;function Ms(s){let{small_blind:t,button:e,seats:i}=s;return Ee.make(t,e,i.map(n=>n.chips))}const fe=class{constructor(t,e,i,n){this.history=t,this.game=e,this._round=i,this.winner=n}get round(){var t;return(t=this._round)==null?void 0:t.clone}get game_dests(){let{dests:t}=this.game;return t.lea=void 0,t.folds=void 0,t}get round_dests(){var t;return(t=this._round)==null?void 0:t.dests}round_act(t){let e=this._round.act(t),{dests:i}=this._round;if((i.phase||!i.dealer_action)&&(this.history.length===10&&this.history.shift(),this.history.push(Ee.from_fen(this._round.fen))),i.fin){let n=this._round.stacks.findIndex(r=>r.stack===0)+1;if(n!==0)this._round=void 0,this.game=void 0,this.winner=Is(2,n);else{let r=this._round.stacks.map(l=>l.stack).join("-");return this._round=void 0,this.game.act(`share ${r}`)}}return e}game_act(t){let[e,i]=t.split(" ");switch(e){case"deal":return this._round=Ms(this.game),this.game.act(t)}}};g(fe,"make",()=>{let s=10,t=Ze.headsup(s),e=s*300;return t.act(`sit 1-${e}`),t.act(`sit 2-${e}`),new fe([],t)});var Os=A('<svg><path d="M282.483,361.931L282.483,361.931c0,0,44.323,44.323,79.448-8.828c18.282-27.666,5.888-54.616-13.603-73.242    l-83.906-82.635c-4.723-4.025-11.979-4.025-16.711,0l-85.124,82.635c-16.746,17.523-31.011,45.506-12.518,73.242    c35.31,52.966,79.448,8.828,79.448,8.828c0,22.625-6.444,51.703-8.324,59.683c-0.256,1.112,0.6,2.11,1.739,2.11h66.145    c1.139,0,1.986-0.997,1.73-2.101C288.936,413.617,282.483,384.415,282.483,361.931"></svg>',!1,!0),Ns=A('<svg><polygon points="256,176.552 150.069,308.966 256,441.379 361.931,308.966   "></svg>',!1,!0),qs=A('<svg><path d="M256,238.345c9.507-24.214,29.625-44.138,54.881-44.138c21.257,0,40.201,9.993,52.966,26.483    c16.013,20.692,27.33,66.754-7.715,101.8C338.353,340.268,256,423.724,256,423.724s-82.353-83.456-100.131-101.235    c-35.046-35.046-23.729-81.108-7.715-101.8c12.765-16.49,31.709-26.483,52.966-26.483    C226.375,194.207,246.493,214.131,256,238.345"></svg>',!1,!0),Ls=A('<svg><path d="M282.482,370.759c0,21.91,6.047,43.82,8.13,50.732c0.344,1.139-0.521,2.233-1.704,2.233h-65.827    c-1.183,0-2.039-1.095-1.704-2.225c2.074-6.947,8.139-29.096,8.139-50.741c-8.722,6.321-18.803,9.578-29.917,9.578    c-32.274,0-60.275-27.101-58.253-59.78c1.13-18.379,12.835-34.145,28.425-43.926c15.651-9.825,30.164-10.611,43.14-7.459    c-8.298-9.825-13.312-22.502-13.312-36.361c0-34.834,31.576-62.296,67.663-55.314c22.59,4.361,40.545,22.925,44.332,45.612    c2.948,17.602-2.304,33.986-12.5,46.062c13.065-3.169,27.692-2.348,43.467,7.662c15.519,9.852,27.18,25.582,28.248,43.926    c1.889,32.591-26.2,59.577-58.403,59.577C301.444,380.337,291.045,376.947,282.482,370.759"></svg>',!1,!0),Bs=A('<div class=suit><svg width=100% height=100% viewBox="0 0 512 512">'),Ks=A("<div><div class=inner><div><div class=rank></div><div class=suit-left> <!> </div><div class=suit-middle> <!> </div></div><div class=back>"),Hs=A("<div><div class=card-holder>"),ts=A("<div>"),Us=A("<div class=hand>"),Fs=A("<div class=middle><div><span></span></div><div class=ftr>"),Ds=A("<span><span>li"),Rs=A('<span class="inline chips"><span>li'),Qs=A("<div><div class=handle><span>Handle</span></div><div class=stack-wrap><div class=bets></div><div> <h3>Stack</h3> "),Vs=A("<div class=turn-left><div class=bar>"),Js=A("<span>Fold"),Ws=A("<span>Check"),Gs=A("<span>Call"),Xs=A("<span class=raise>Raise "),Ys=A("<div class=event><span class=name>Texas No-Limit Hold'em Headsup Tournament</span><span class=desc>A Texas No-Limit Hold'em Headsup Tournament organized by liheadsup</span><span class=players><span>Players Left:</span> <span>3</span></span><span class=blinds><span>Blinds:</span> <span>/</span></span><span class=next-level><span>Next Level:</span> 02:00 </span><span class=prize><span>Prize:"),zs=A("<div class=logo><span>li</span><span>headsup"),Zs=A("<div class=dealer><div class=card-wrap><div class=card-holder></div></div><div><h3>Main Pots"),ti=A("<div class=people>"),ei=A("<div class=hands><div class=buttons><button>Deal Cards</button><button>Deal Flop</button><button>Deal Rest</button><button>Collect Cards"),si=A("<div class=showcase>"),ii=A("<section><h2></h2><div class=area>");const ni=["one","two","three","four","five","six"],ri=s=>{if(s.raise)return"raise";if(s.fold)return"fold";if(s.check)return"check";if(s.call)return"call"},li=s=>{switch(s){case"d":return"diamonds";case"h":return"hearts";case"c":return"clubs";case"s":return"spades"}},_e=s=>(()=>{var t=Bs(),e=t.firstChild;return m(e,w(gs,{get children(){return[w(ft,{get when(){return s.suit==="s"},get children(){return Os()}}),w(ft,{get when(){return s.suit==="d"},get children(){return Ns()}}),w(ft,{get when(){return s.suit==="h"},get children(){return qs()}}),w(ft,{get when(){return s.suit==="c"},get children(){return Ls()}})]}})),t})(),ai=s=>{let[t,e]=s.card.split("");t=t.replace("T","10");let i=L(()=>s.class?"card "+s.class:"card");return(()=>{var n=Ks(),r=n.firstChild,l=r.firstChild,a=l.firstChild,h=a.nextSibling,u=h.firstChild,f=u.nextSibling;f.nextSibling;var o=h.nextSibling,c=o.firstChild,d=c.nextSibling;return d.nextSibling,m(a,t),m(h,w(_e,{suit:e}),f),m(o,w(_e,{suit:e}),d),q(_=>{var p=i(),$="front decoration "+li(e);return p!==_.e&&B(n,_.e=p),$!==_.t&&B(l,_.t=$),_},{e:void 0,t:void 0}),n})()},X=s=>(()=>{var t=Hs();return t.firstChild,m(t,w(H,{get when(){return s.card.value},children:e=>(()=>{var i=ts();return m(i,w(ai,{get class(){return s.card.klass},get card(){return e()}})),q(()=>B(i,"elevate "+s.elevate.klass)),i})()}),null),q(()=>B(t,"card-wrap "+(s.class??""))),t})(),hi=s=>(()=>{var t=Us();return m(t,w(X,U(()=>s.hand[0])),null),m(t,w(X,U(()=>s.hand[1])),null),t})(),oi=s=>(()=>{var t=Fs(),e=t.firstChild,i=e.firstChild,n=e.nextSibling;return m(i,()=>s.showdown_info.value),m(n,w(X,U({get class(){return"flop "+s.flop[0].card.klass}},()=>s.flop[0])),null),m(n,w(X,U({get class(){return"flop "+s.flop[1].card.klass}},()=>s.flop[1])),null),m(n,w(X,U({get class(){return"flop "+s.flop[2].card.klass}},()=>s.flop[2])),null),m(n,w(X,U({get class(){return"turn "+s.turn.card.klass}},()=>s.turn)),null),m(n,w(X,U({get class(){return"river "+s.river.card.klass}},()=>s.river)),null),q(()=>B(e,"showdown-info "+s.showdown_info.klass)),t})(),le=s=>[" ",(()=>{var t=Ds(),e=t.firstChild;return m(t,()=>s.chips,e),q(()=>B(t,"pot chips "+(s.class??""))),t})()," "],vt=s=>[" ",(()=>{var t=Rs(),e=t.firstChild;return m(t,()=>s.chips,e),t})()," "],ci=s=>{const t=L(()=>{let e=s.state.value,i="";return e==="@"&&(i+=" turn"),e==="i"&&(i+=" in"),e==="f"&&(i+=" folded"),i+=" "+s.class,i});return(()=>{var e=Qs(),i=e.firstChild;i.firstChild;var n=i.nextSibling,r=n.firstChild,l=r.nextSibling,a=l.firstChild,h=a.nextSibling;return h.nextSibling,m(i,w(hi,s),null),m(n,w(H,{get when(){return s.turn_left.value},children:u=>(()=>{var f=Vs(),o=f.firstChild;return q(c=>bs(o,`width: ${u()}%;`,c)),f})()}),r),m(r,w(H,{get when(){return s.bet.value},children:u=>[(()=>{var f=ts();return m(f,w(H,{get when(){return u().raise},children:o=>(()=>{var c=Xs();return c.firstChild,m(c,w(vt,{get chips(){return o()}}),null),c})()}),null),m(f,w(H,{get when(){return u().fold},get children(){return Js()}}),null),m(f,w(H,{get when(){return u().check},get children(){return Ws()}}),null),m(f,w(H,{get when(){return u().call},get children(){return Gs()}}),null),q(()=>B(f,["bet",s.bet.klass,ri(u())].join(" "))),f})(),w(H,{get when(){return u().chips},children:f=>w(le,{get chips(){return f()}})})]})),m(l,w(le,{get chips(){return s.chips.value??0}}),null),q(u=>{var f="person "+t(),o="stack "+s.chips.klass;return f!==u.e&&B(e,u.e=f),o!==u.t&&B(l,u.t=o),u},{e:void 0,t:void 0}),e})()},ui=()=>(()=>{var s=Ys(),t=s.firstChild,e=t.nextSibling,i=e.nextSibling,n=i.nextSibling,r=n.firstChild,l=r.nextSibling,a=l.nextSibling,h=a.firstChild,u=n.nextSibling,f=u.nextSibling;return f.firstChild,m(a,w(vt,{chips:10}),h),m(a,w(vt,{chips:20}),null),m(f,w(vt,{chips:3e3}),null),s})(),di=s=>[zs(),(()=>{var t=Zs(),e=t.firstChild,i=e.nextSibling;return i.firstChild,m(t,w(ui,{}),e),m(t,w(oi,U(()=>s.middle)),i),m(i,w(H,{get when(){return s.pot.value},children:n=>w(le,{class:"pop",get chips(){return n()}})}),null),q(()=>B(i,"pots pops "+s.pot.klass)),t})(),(()=>{var t=ti();return m(t,w(ps,{get each(){return s.people},children:e=>w(ci,U(e))})),t})()],pe=s=>{const[t,e]=Y(ni[s-1]);let i=fi({init_delay:300,update_delay:2e3,exit_delay:300}),n=D({init_delay:100,update_delay:200,exit_delay:300}),r=D({init_delay:300,update_delay:2e3,exit_delay:300}),l=D({init_delay:300,update_delay:2e3,exit_delay:300}),a=D({init_delay:300,update_delay:2e3,exit_delay:300});return{set_chips(h){return n.set_target(h)},turn_left:a,hand:i.cards,chips:n,state:r,bet:l,get class(){return t()}}},z=s=>{const t=D(s),e=D({update_delay:8e3}),i=D(s);return{card:t,elevate:e,back:i,set_card(n){return t.set_target(n)},set_elevate(n){return e.set_target(n.includes(t.value??""))},set_back(n){return i.set_target(n)}}},fi=s=>({cards:[z(s),z(s)],set_cards(t){return this.cards[0].set_card(t==null?void 0:t[0]),this.cards[1].set_card(t==null?void 0:t[1])}}),_i=s=>({cards:[z(s),z(s),z(s)],set_cards(t){return this.cards[0].set_card(t==null?void 0:t[0]),this.cards[1].set_card(t==null?void 0:t[1]),this.cards[2].set_card(t==null?void 0:t[2])}}),pi=()=>{const[s,t]=Y([pe(1),pe(2)]);let e=_i({init_delay:300,update_delay:2e3,exit_delay:300}),i=z({init_delay:300,update_delay:3e3,exit_delay:300}),n=z({init_delay:300,update_delay:3500,exit_delay:300}),r=D({update_delay:300,exit_delay:1e3}),l=D({update_delay:6e3,exit_delay:1e3});const a=L(()=>({flop:e.cards,turn:i,river:n,showdown_info:l})),h=L(()=>s());return{pot:r,get middle(){return a()},get people(){return h()},set_flop(u){return e.set_cards(u)},set_turn(u){return i.set_card(u)},set_river(u){return n.set_card(u)},set total_pot(u){r.set_target(u)},reveal_middle(u){let f=u.slice(0,3),o=u[3],c=u[4],d=Promise.resolve();return d=d.then(()=>e.set_cards(f)),d=d.then(()=>i.set_card(o)),d=d.then(()=>n.set_card(c)),d},set_showdown_info(u){let f=Promise.resolve();return u==null||u.forEach(o=>{if(!o){f=f.then(()=>l.set_target(void 0));return}f=f.then(()=>l.set_target(o.desc));let c=o.cards;f=f.then(()=>{let d=h()[o.side-1].hand,_=d[0].set_elevate(c),p=d[1].set_elevate(c);return console.log("set elevate",c),Promise.all([e.cards[0].set_elevate(c),e.cards[1].set_elevate(c),e.cards[2].set_elevate(c),i.set_elevate(c),n.set_elevate(c),_,p]).then(()=>{})})}),f}}},gi=()=>{const s=pi();return setTimeout(()=>{let t=Promise.resolve();t=t.then(()=>s.set_flop(["Ah","Ac","Ad"])),t=t.then(()=>s.set_turn("Td")),t=t.then(()=>s.set_river("Ts")),s.total_pot=100,s.people[0].set_chips(1e3),t=t.then(()=>s.set_showdown_info([{desc:"High Card A J 3",cards:Q("AhAcAdTdTs"),side:1,chips:100},{desc:"Two Pair A K Q",cards:Q("AhAcKcKdTs"),side:2,chips:100}])),t.then(()=>{console.log("done")})},1e3),setTimeout(()=>{},5e3),setTimeout(()=>{},1e4),(()=>{var t=si();return m(t,w(vi,{header:"Card",get children(){var e=ei(),i=e.firstChild;return m(e,w(di,s),i),e}})),t})()},vi=s=>(()=>{var t=ii(),e=t.firstChild,i=e.nextSibling;return m(e,()=>s.header),m(i,()=>s.children),t})(),D=function(s,t){let[e,i]=Y(t,{equals:!1}),n=(s.init_delay??0)+300,r=n+(s.update_delay??0),l=s.exit_delay??0;const[a,h]=Y(!1),[u,f]=Y("updatable"),[o,c]=Y(void 0);let d=[];return ns(rs(e,(_,p)=>{let $,C;console.log(p,_,r,d),p&&_===void 0?(f("updatable exiting"),C=setTimeout(()=>{It(()=>{c(void 0),f("updatable"),d.forEach(b=>b()),d=[]})},l)):p!==_?(h(!1),f("updatable init"),C=setTimeout(()=>{It(()=>{f("updatable updating"),c(()=>_)})},n),$=setTimeout(()=>{f("updatable updated"),h(!0),console.log("clear ",p,_,d),d.forEach(b=>b()),d=[]},r)):(d.forEach(b=>b()),d=[]),we(()=>{It(()=>{console.log("clear cleanup",p,_,d),h(!1),c(()=>_)}),clearTimeout(C),clearTimeout($)})})),{get resolve_on_updated(){return new Promise(_=>{d.push(_)})},get updated(){return a()},get klass(){return u()},get value(){return o()},set_target(_){let p=this.resolve_on_updated;return i(()=>_),p}}};function wi(){return w(gi,{})}const mi=document.getElementById("root");ws(()=>w(wi,{}),mi);
